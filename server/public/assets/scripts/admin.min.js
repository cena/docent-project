/*! docentedu 2015-09-27 */
function getResources(a){$.ajax({type:"GET",dataType:"json",url:"/resources",success:function(b){b.resources.sort(compareAlphabetically),a(b.resources)}})}function displayAdmin(a){$(".resourceRow").remove(),console.log(a);for(var b=0;b<a.length;b++){if(tags="",embedName=a[b].embedName,logo=a[b].logo,embedLink=a[b].embedLink?a[b].embedLink:"",howto=a[b].howto?a[b].howto:"",description=a[b].description?a[b].description:"",category=a[b].category?a[b].category:"",subject=a[b].subject?a[b].subject:"",null!==a[b].tags&&0!==a[b].tags)for(var c=0;c<a[b].tags.length;c++)tags+='<p class="tag">'+a[b].tags[c]+"</p>";$("#admin").append('<tr class="resourceRow" data-id="'+a[b]._id+'"><td>'+embedName+"</td><td>"+logo+'</td><td class="embedlink">'+embedLink+'</td><td class="howtolink">'+howto+'</td><td class="description">'+description+"</td><td>"+category+"</td><td>"+subject+"</td><td>"+tags+'</td><td><button type="submit" class="editButton">Edit</button><button type="submit" class="deleteButton">Delete</button></td></tr>'),console.log("displayAdmin function working!")}}function postNewResource(){for(tagArray=$("input#tags").val().split(","),i=0;i<tagArray.length;i++)tagArray[i]=tagArray[i].trim();var a={embedName:$("input#embedName").val(),embedLink:$("input#embedLink").val(),logo:$("input#logo").val(),howto:$("input#howto").val(),description:$("textarea#description").val(),category:$("input#category").val(),tags:tagArray,subject:$("input#subject").val()};$.ajax({type:"POST",url:"/resources/new",data:a,success:function(){console.log("POST sent")},error:function(a,b){console.log("Error: "+b,+a)},complete:function(){console.log("POST Complete!")}})}function compareAlphabetically(a,b){return a.embedName<b.embedName?-1:a.embedName>b.embedName?1:0}$(document).ready(function(){$("table").on("click",".deleteButton",function(){$(".deleteModal").modal("show");var a=$(this).parent().parent(),b=a[0].dataset.id;console.log(b),$("#deleteModal").on("click","#deleteButton",function(){$.ajax({type:"DELETE",url:"/resources/"+b,success:function(){console.log("Deletion sent")},error:function(a,b){alert("Error: "+b)},complete:function(){console.log("Delete Complete!"),$(".deleteModal").modal("hide"),a.remove()}})})}),$(".newResourceButton").on("click",function(){$(".newModal").modal("show")}),$("table").on("click",".editButton",function(){var a=$(this).parent().parent(),b=a[0].dataset.id;console.log(b),$(".editModal").modal("show"),$.ajax({type:"GET",url:"/resources/"+b,success:function(a){console.log("table edit btn ajax get call working"),console.log(a),$(".modal-title").text(a.embedName),$("#resourceName").val(a.embedName),$(".resourceLink").val(a.embedLink),$(".howToLink").val(a.howto),$(".resDescrip").val(a.description),$(".resCategory").val(a.category),$(".resSubject").val(a.subject),$(".resTags").val(a.tags)}}),$(".editModal").on("click",".submitButton",function(){var a,c,d,e,f,g,h,j;for(tagArray=$(".resTags").val().split(","),i=0;i<tagArray.length;i++)tagArray[i]=tagArray[i].trim();$(".editForm").change(function(){a=$("#resourceName").val(),c=$(".logoLink").val(),d=$(".resourceLink").val(),e=$(".howToLink").val(),f=$(".resDescrip").val(),g=$(".resCategory").val(),h=$(".resSubject").val(),j=tagArray}).change();var k={embedName:a,logo:c,embedLink:d,howto:e,description:f,category:g,subject:h,tags:j};$.ajax({type:"PUT",url:"/resources/edits/"+b,data:k,dataType:"json",success:function(){console.log("data being put: ",k)},error:function(a,b){alert("Error: "+b)},complete:function(){$("#newEmbedForm")[0].reset(),$(".editModal").modal("hide"),getResources()}})})}),$("#newModal").on("click","#submitNew",function(){postNewResource(),$("#newModal").modal("show"),$("#newEmbedForm")[0].reset(),getResources()}),getResources(function(a){console.log(a),displayAdmin(a)})});